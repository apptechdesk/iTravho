(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{1401:(e,t,a)=>{Promise.resolve().then(a.bind(a,41720))},24999:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(95155),l=a(12115),s=a(34303);let i=(0,l.forwardRef)((e,t)=>{let{children:a,addClass:l,btnType:i="button",...o}=e;return(0,r.jsx)(s.Ay,{ref:t,htmlType:i,className:"btn ".concat(l||""),...o,children:a})});i.displayName="CustomButton";let o=i},41720:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(95155),l=a(12115),s=a(6791),i=a(35695),o=a(11025),n=a(57340),d=a(69074),c=a(30832),u=a.n(c);let m=e=>{let{route:t,destination:a,date:l,passengers:s}=e,o=(0,i.useRouter)(),c=u()(l).format("DD-MM-YYYY");return(0,r.jsxs)("div",{className:" space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-xs text-blue-700 font-semibold mb-2 underline underline-offset-4",children:"Create Quote"}),(0,r.jsx)("button",{onClick:()=>o.push("/dashboard/"),className:"text-blue-700 hover:text-blue-900 transition-colors","aria-label":"Go to dashboard",children:(0,r.jsx)(n.A,{size:16})})]}),(0,r.jsx)("div",{className:"h-0.5 bg-gray-100 mb-5"}),(0,r.jsxs)("div",{className:"bg-primary text-white rounded-lg px-6 py-3 grid grid-cols-3 items-center text-sm md:text-base shadow-md w-full",children:[(0,r.jsx)("div",{className:"font-semibold whitespace-nowrap",children:t}),(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap justify-center",children:[(0,r.jsx)(d.A,{className:"h-4 w-4 text-white"}),(0,r.jsx)("span",{children:c})]}),(0,r.jsxs)("div",{className:"whitespace-nowrap flex justify-end",children:[s," Passenger",s>1?"s":""]})]})]})};var x=a(68534),p=a(66766);let h=e=>{let{airlineLogoUrl:t,airlineName:a,flightType:l,duration:s,departureTime:i,arrivalTime:o,departureDate:n,arrivalDate:d,departureAirport:c,arrivalAirport:m,price:h,currency:v="USD",flightRoute:f,brandName:g,onSelect:b}=e;return(0,r.jsxs)("div",{className:"border border-borderColor rounded-xl shadow-sm p-4 bg-white mb-5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 w-1/3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(p.default,{src:t,alt:a,className:"w-12 h-12 rounded-md object-contain",width:80,height:80}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:a})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-semibold text-gray-900",children:l}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:s})]})]}),(0,r.jsx)("div",{className:"text-center w-1/2",children:(0,r.jsxs)("div",{className:"flex justify-center items-center space-x-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-lg",children:i}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[c," - ",u()(n).format("DD MMM")]})]}),(0,r.jsx)("div",{className:"w-8 border-t border-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-lg",children:o}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[m," - ",u()(d).format("DD MMM")]})]})]})}),(0,r.jsxs)("div",{className:"flex flex-col items-end w-1/3 space-y-2",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"font-semibold text-gray-900 text-lg",children:[v," ",h.toFixed(2)]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Price per person ",(0,r.jsx)("br",{}),"(incl. taxes & fees)"]})]}),(0,r.jsx)(x.A,{variant:"contained",color:"error",size:"small",className:"rounded-full",onClick:b,children:"Select"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"text-xs text-indigo-600 mt-1 p-1 border rounded-sm border-borderColor",children:f}),(0,r.jsx)("div",{className:"text-xs text-indigo-600 mt-1 p-1 border rounded-sm border-borderColor",children:g})]})]})};var v=a(35297),f=a(3127),g=a(81284);let b=e=>{let{details:t}=e;return(0,r.jsx)("div",{className:"border border-borderColor rounded-md p-4 w-full text-sm bg-white shadow-sm",children:(0,r.jsx)("table",{className:"w-full table-auto",children:(0,r.jsx)("tbody",{children:t.map((e,t)=>{let{label:a,value:l,tooltip:s}=e;return(0,r.jsxs)("tr",{className:"border-b border-borderColor last:border-b-0",children:[(0,r.jsxs)("td",{className:"py-2 pr-2 font-medium text-gray-600 flex items-center",children:[a,s&&(0,r.jsx)(v.A,{title:s,arrow:!0,children:(0,r.jsx)(f.A,{size:"small",className:"ml-1",children:(0,r.jsx)(g.A,{size:14})})})]}),(0,r.jsx)("td",{className:"py-2 text-gray-900",children:l})]},t)})})})})},j=e=>{let{options:t,selected:a,onChange:l}=e;return(0,r.jsx)("div",{className:"flex justify-between items-center border border-borderColor rounded-lg overflow-hidden shadow-sm bg-white",children:t.map(e=>(0,r.jsxs)("button",{onClick:()=>l(e.value),className:"flex items-center justify-center relative flex-1 cursor-pointer py-3 text-sm font-medium transition-colors ".concat(a===e.value?"text-blue-600":"text-gray-800"),children:[(0,r.jsx)("span",{children:e.label}),e.tooltip&&(0,r.jsx)(v.A,{title:e.tooltip,arrow:!0,children:(0,r.jsx)(f.A,{size:"small",className:"ml-1",children:(0,r.jsx)(g.A,{size:16})})}),a===e.value&&(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-600"})]},e.value))})};var N=a(24999);let y=[{label:"Best",value:"best",tooltip:"Best balance of price and duration."},{label:"Cheapest",value:"cheapest",tooltip:"Lowest price first."},{label:"Fastest",value:"fastest",tooltip:"Shortest duration first."}],w=()=>{(0,i.useRouter)();let e=(0,i.useSearchParams)(),t=t=>e.get(t)||"",a=(t,a)=>e.get(t)||a||"",n={name:t("name"),rank:t("rank"),seamanBookNo:t("seamanBookNo"),passport:t("passport"),issuedDate:t("issuedDate"),expiryDate:t("expiryDate"),issuedAt:t("issuedAt"),nationality:t("nationality"),dob:t("dob"),baggage:t("baggage"),passengerCount:parseInt(t("passengerCount"))||1,from:t("from"),to:t("to"),departureDate:t("departureDate"),route:t("route")},d={name:a("name",n.name),route:a("route",n.route),date:a("date",n.departureDate),travelFromCode:a("travelFromCode",n.from),travelToCode:a("travelToCode",n.to)},[c,u]=(0,l.useState)("best"),[x,p]=(0,l.useState)([]),[v,f]=(0,l.useState)(""),[g,w]=(0,l.useState)(!0),[A,C]=(0,l.useState)(1),D=(0,l.useMemo)(()=>(function(e,t){switch(t){case"cheapest":return[...e].sort((e,t)=>e.price-t.price);case"fastest":{let t=Math.min(...e.map(e=>{let t=e.flightType.match(/\d+/);return t?parseInt(t[0]):0}));return[...e].filter(e=>{let a=e.flightType.match(/\d+/);return(a?parseInt(a[0]):0)===t}).sort((e,t)=>e.totalDuration-t.totalDuration)}default:return[...e].sort((e,t)=>e.price+e.totalDuration/60-(t.price+t.totalDuration/60))}})(x,c),[x,c]),T=D.slice(0,5*A),S=D.length>T.length;return(0,l.useEffect)(()=>{C(1)},[c]),(0,l.useEffect)(()=>{(async()=>{w(!0),f("");try{var e,t,a;let r=await fetch("/api/travelport/catalog",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CatalogProductOfferingsQueryRequest:{CatalogProductOfferingsRequest:{"@type":"CatalogProductOfferingsRequestAir",maxNumberOfUpsellsToReturn:4,offersPerPage:10,contentSourceList:["GDS"],sortBy:"Price-LowToHigh",SearchCriteriaFlight:[{departureDate:d.date,From:{value:d.travelFromCode},To:{value:d.travelToCode}}],SearchModifiersAir:{CarrierPreference:[{preferenceType:"Preferred",carriers:[]}]}}}})});if(!r.ok)throw Error(await r.text());let l=await r.json(),s=(null==l||null==(t=l.CatalogProductOfferingsResponse)||null==(e=t.CatalogProductOfferings)?void 0:e.CatalogProductOffering)||[],i=(null==l||null==(a=l.CatalogProductOfferingsResponse)?void 0:a.ReferenceList)||[],o=new Map,n=new Map;i.forEach(e=>{"ReferenceListFlight"===e["@type"]&&(e.Flight||[]).forEach(e=>o.set(e.id,e)),"ReferenceListBrand"===e["@type"]&&(e.Brand||[]).forEach(e=>n.set(e.id,e))});let c=s.flatMap(e=>e.ProductBrandOptions.flatMap(t=>t.ProductBrandOffering.map((a,r)=>{var l,s,i,d,c,u,m,x,p,h,v,f,g,b,j,N,y,w,A,C,D;let T=a.BestCombinablePrice||{},S=null==(l=a.Brand)?void 0:l.BrandRef,P=n.get(S),B=t.flightRefs.map(e=>o.get(e)).filter(Boolean),M=B.reduce((e,t)=>e+function(e){var t,a;let r=e.match(/(\d+)H(?:([0-9]+)M)?/i),l=parseInt(null!=(t=null==r?void 0:r[1])?t:"0"),s=parseInt(null!=(a=null==r?void 0:r[2])?a:"0");return isNaN(l)&&isNaN(s)?0:60*l+s}((null==t?void 0:t.duration)||""),0),k=B.map(e=>{var t;return null==(t=e.Departure)?void 0:t.location}).join(" → ")+" → "+(null==(i=B[B.length-1])||null==(s=i.Arrival)?void 0:s.location),O=Math.max(0,B.length-1);return{id:"".concat(e.id,"-").concat(S,"-").concat(r),airlineName:(null==(d=B[0])?void 0:d.carrier)||"Unknown Airline",airlineLogoUrl:"https://content.r9cdn.net/rimg/provider-logos/airlines/v/".concat((null==(c=B[0])?void 0:c.carrier)||"XX",".png"),flightType:0===O?"Non stop":1===O?"1 stop":"".concat(O," stops"),duration:"".concat(Math.floor(M/60),"h").concat(M%60,"m"),totalDuration:M,flightRoute:k,departureTime:(null==(m=B[0])||null==(u=m.Departure)?void 0:u.time)||"",arrivalTime:(null==(p=B[B.length-1])||null==(x=p.Arrival)?void 0:x.time)||"",departureDate:(null==(v=B[0])||null==(h=v.Departure)?void 0:h.date)||"",arrivalDate:(null==(g=B[B.length-1])||null==(f=g.Arrival)?void 0:f.date)||"",departureAirport:(null==(j=B[0])||null==(b=j.Departure)?void 0:b.location)||e.Departure,arrivalAirport:(null==(y=B[B.length-1])||null==(N=y.Arrival)?void 0:N.location)||e.Arrival,price:T.TotalPrice||0,currency:(null==(w=T.CurrencyCode)?void 0:w.value)||"USD",baggage:(null==P||null==(C=P.BrandAttribute)||null==(A=C.find(e=>"CheckedBag"===e.classification))?void 0:A.inclusion)||"N/A",brandName:(null==P?void 0:P.name)||"",brandImage:(null==P||null==(D=P.ImageURL)?void 0:D[0])||"",fareBreakdown:[{type:"Base Fare",amount:T.Base||0},{type:"Taxes & Fees",amount:T.TotalTaxes||0}]}})));p(c)}catch(e){f(e instanceof Error?e.message:"Unknown error")}finally{w(!1)}})()},[d.date,d.travelFromCode,d.travelToCode]),(0,r.jsx)(o.A,{children:(0,r.jsxs)("div",{className:"p-4 space-y-5",children:[(0,r.jsx)(m,{route:d.route,destination:d.travelToCode,date:d.date,passengers:n.passengerCount}),(0,r.jsx)(j,{options:y,selected:c,onChange:u}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-5 space-y-5",children:[(0,r.jsx)("div",{id:"scrollableDiv",className:"max-h-[500px] overflow-y-auto",children:(0,r.jsx)(s.A,{dataLength:T.length,next:()=>C(e=>e+1),hasMore:S,scrollableTarget:"scrollableDiv",loader:(0,r.jsx)("p",{className:"text-sm",children:"Loading more flights..."}),children:0===T.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No flights available."}):T.map(e=>(0,r.jsx)(h,{airlineLogoUrl:e.airlineLogoUrl,airlineName:e.airlineName,flightType:e.flightType,duration:e.duration,departureTime:e.departureTime,arrivalTime:e.arrivalTime,departureDate:e.departureDate,arrivalDate:e.arrivalDate,departureAirport:e.departureAirport,arrivalAirport:e.arrivalAirport,price:e.price,currency:e.currency,flightRoute:e.flightRoute,brandName:e.brandName,onSelect:()=>alert("Selected flight on ".concat(e.departureTime))},e.id))})}),(0,r.jsx)("div",{children:(0,r.jsx)(b,{details:[{label:"NAME",value:n.name},{label:"RANK",value:String(n.rank||"")},{label:"SEAMAN BOOK NO",value:n.seamanBookNo},{label:"PASSPORT",value:n.passport},{label:"ISSUED DATE",value:n.issuedDate},{label:"EXPIRY DATE",value:n.expiryDate},{label:"ISSUED AT",value:n.issuedAt},{label:"NATIONALITY",value:n.nationality},{label:"DOB",value:n.dob},{label:"BAGGAGE",value:"".concat(n.baggage,"Kg")}]})})]}),(0,r.jsx)("div",{className:"h-0.5 bg-gray-200 mb-5"}),(0,r.jsxs)("div",{className:"grid gap-5 [grid-template-columns:repeat(auto-fit,minmax(140px,1fr))] max-w-sm mx-auto",children:[(0,r.jsx)(N.A,{addClass:"primary w-full",onClick:()=>console.log("Preview Quote"),children:"Preview Quote"}),(0,r.jsx)(N.A,{addClass:"primary w-full",onClick:()=>console.log("Send Quote"),children:"Send Quote"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5534,3063,635,3486,3268,8534,5249,1025,8441,1684,7358],()=>t(1401)),_N_E=e.O()}]);