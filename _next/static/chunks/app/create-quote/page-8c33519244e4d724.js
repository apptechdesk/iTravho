(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{1401:(e,t,r)=>{Promise.resolve().then(r.bind(r,41720))},24999:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155),l=r(12115),s=r(34303);let i=(0,l.forwardRef)((e,t)=>{let{children:r,addClass:l,btnType:i="button",...o}=e;return(0,a.jsx)(s.Ay,{ref:t,htmlType:i,className:"btn ".concat(l||""),...o,children:r})});i.displayName="CustomButton";let o=i},41720:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var a=r(95155),l=r(12115),s=r(6791),i=r(57340),o=r(69074),n=r(35695);let d=e=>{let{route:t,destination:r,date:l,passengers:s}=e,d=(0,n.useRouter)();return(0,a.jsxs)("div",{className:" space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"text-xs text-blue-700 font-semibold mb-2 underline underline-offset-4",children:"Create Quote"}),(0,a.jsx)("button",{onClick:()=>d.push("/dashboard/"),className:"text-blue-700 hover:text-blue-900 transition-colors","aria-label":"Go to dashboard",children:(0,a.jsx)(i.A,{size:16})})]}),(0,a.jsx)("div",{className:"h-0.5 bg-gray-100 mb-5"}),(0,a.jsxs)("div",{className:"bg-primary text-white rounded-lg px-6 py-3 flex justify-between items-center text-sm md:text-base shadow-md w-full",children:[(0,a.jsx)("div",{className:"font-semibold whitespace-nowrap",children:t}),(0,a.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 text-white"}),(0,a.jsx)("span",{children:l})]}),(0,a.jsxs)("div",{className:"whitespace-nowrap",children:[s," Passenger",s>1?"s":""]})]})]})};var c=r(11025),u=r(68534),m=r(66766);let x=e=>{let{airlineLogoUrl:t,airlineName:r,flightType:l,duration:s,departureTime:i,arrivalTime:o,departureAirport:n,arrivalAirport:d,price:c,currency:x="USD",flightRoute:h,brandName:p,onSelect:v}=e;return(0,a.jsxs)("div",{className:"border border-borderColor rounded-xl shadow-sm p-4 bg-white mb-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4 w-1/3",children:[(0,a.jsx)(m.default,{src:t,alt:r,className:"w-12 h-12 rounded-md object-contain",width:80,height:80}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:l}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:s}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:r})]})]}),(0,a.jsx)("div",{className:"text-center w-1/3",children:(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-bold text-lg",children:i}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:n})]}),(0,a.jsx)("div",{className:"w-8 border-t border-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-bold text-lg",children:o}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:d})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col items-end w-1/3 space-y-2",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-900 text-lg",children:[x," ",c.toFixed(2)]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Price per person ",(0,a.jsx)("br",{}),"(incl. taxes & fees)"]})]}),(0,a.jsx)(u.A,{variant:"contained",color:"error",size:"small",className:"rounded-full",onClick:v,children:"Select"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"text-xs text-indigo-600 mt-1 p-1 border rounded-sm border-borderColor",children:h}),(0,a.jsx)("div",{className:"text-xs text-indigo-600 mt-1 p-1 border rounded-sm border-borderColor",children:p})]})]})};var h=r(35297),p=r(3127),v=r(81284);let f=e=>{let{details:t}=e;return(0,a.jsx)("div",{className:"border border-borderColor rounded-md p-4 w-full text-sm bg-white shadow-sm",children:(0,a.jsx)("table",{className:"w-full table-auto",children:(0,a.jsx)("tbody",{children:t.map((e,t)=>{let{label:r,value:l,tooltip:s}=e;return(0,a.jsxs)("tr",{className:"border-b border-borderColor last:border-b-0",children:[(0,a.jsxs)("td",{className:"py-2 pr-2 font-medium text-gray-600 flex items-center",children:[r,s&&(0,a.jsx)(h.A,{title:s,arrow:!0,children:(0,a.jsx)(p.A,{size:"small",className:"ml-1",children:(0,a.jsx)(v.A,{size:14})})})]}),(0,a.jsx)("td",{className:"py-2 text-gray-900",children:l})]},t)})})})})},g=e=>{let{options:t,selected:r,onChange:l}=e;return(0,a.jsx)("div",{className:"flex justify-between items-center border border-borderColor rounded-lg overflow-hidden shadow-sm bg-white",children:t.map(e=>(0,a.jsxs)("button",{onClick:()=>l(e.value),className:"flex items-center justify-center relative flex-1 cursor-pointer py-3 text-sm font-medium transition-colors ".concat(r===e.value?"text-blue-600":"text-gray-800"),children:[(0,a.jsx)("span",{children:e.label}),e.tooltip&&(0,a.jsx)(h.A,{title:e.tooltip,arrow:!0,children:(0,a.jsx)(p.A,{size:"small",className:"ml-1",children:(0,a.jsx)(v.A,{size:16})})}),r===e.value&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-600"})]},e.value))})};var b=r(24999);let j=[{label:"Best",value:"best",tooltip:"We look at the price, travel time, number of stops and baggage allowance to determine which options you might like best."},{label:"Cheapest",value:"cheapest",tooltip:"Low price"},{label:"Fastest",value:"fastest",tooltip:"Quick time"}],N=()=>{var e;let t=(0,n.useSearchParams)(),[r,i]=(0,l.useState)("best"),[o,u]=(0,l.useState)([]),[m,h]=(0,l.useState)(""),[p,v]=(0,l.useState)(!0),[N,y]=(0,l.useState)(1),w={name:t.get("name"),route:t.get("route"),date:t.get("date"),travelFromCode:t.get("travelFromCode"),travelToCode:t.get("travelToCode")};console.log("tripData",w),(0,l.useEffect)(()=>{y(1)},[r]);let A=(0,l.useMemo)(()=>(function(e,t){switch(t){case"cheapest":return[...e].sort((e,t)=>e.price-t.price);case"fastest":{let t=Math.min(...e.map(e=>{let t=e.flightType.match(/\d+/);return t?parseInt(t[0]):0}));return[...e.filter(e=>{let r=e.flightType.match(/\d+/);return(r?parseInt(r[0]):0)===t})].sort((e,t)=>e.totalDuration-t.totalDuration)}default:return[...e].sort((e,t)=>e.price+e.totalDuration/60-(t.price+t.totalDuration/60))}})(o,r),[o,r]),C=A.slice(0,5*N),T=A.length>C.length;return(0,l.useEffect)(()=>{(async()=>{v(!0),h("");try{var e,t,r;let a=await fetch("/api/travelport/catalog",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CatalogProductOfferingsQueryRequest:{CatalogProductOfferingsRequest:{"@type":"CatalogProductOfferingsRequestAir",maxNumberOfUpsellsToReturn:4,offersPerPage:10,contentSourceList:["GDS"],sortBy:"Price-LowToHigh",SearchCriteriaFlight:[{departureDate:w.date,From:{value:w.travelFromCode},To:{value:w.travelToCode}}],SearchModifiersAir:{CarrierPreference:[{preferenceType:"Preferred",carriers:[]}]}}}})});if(!a.ok)throw Error(await a.text());let l=await a.json(),s=(null==l||null==(t=l.CatalogProductOfferingsResponse)||null==(e=t.CatalogProductOfferings)?void 0:e.CatalogProductOffering)||[],i=(null==l||null==(r=l.CatalogProductOfferingsResponse)?void 0:r.ReferenceList)||[],o=new Map,n=new Map;i.forEach(e=>{"ReferenceListFlight"===e["@type"]&&(e.Flight||[]).forEach(e=>o.set(e.id,e)),"ReferenceListBrand"===e["@type"]&&(e.Brand||[]).forEach(e=>n.set(e.id,e))});let d=s.flatMap(e=>e.ProductBrandOptions.flatMap(t=>t.ProductBrandOffering.map((r,a)=>{var l,s,i,d,c,u,m,x,h,p,v,f,g,b,j,N,y;let w=r.BestCombinablePrice||{},A=null==(l=r.Brand)?void 0:l.BrandRef,C=n.get(A),T=t.flightRefs.map(e=>o.get(e)).filter(Boolean),P=T.reduce((e,t)=>e+function(e){var t,r;let a=e.match(/(\d+)H(?:([0-9]+)M)?/i),l=parseInt(null!=(t=null==a?void 0:a[1])?t:"0"),s=parseInt(null!=(r=null==a?void 0:a[2])?r:"0");return isNaN(l)&&isNaN(s)?0:60*l+s}((null==t?void 0:t.duration)||""),0),S=T.map(e=>{var t;return null==(t=e.Departure)?void 0:t.location}).join(" → ")+" → "+(null==(i=T[T.length-1])||null==(s=i.Arrival)?void 0:s.location),B=Math.max(0,T.length-1);return{id:"".concat(e.id,"-").concat(A,"-").concat(a),airlineName:(null==(d=T[0])?void 0:d.carrier)||"Unknown Airline",airlineLogoUrl:"https://content.r9cdn.net/rimg/provider-logos/airlines/v/".concat((null==(c=T[0])?void 0:c.carrier)||"XX",".png"),flightType:0===B?"Non stop":1===B?"1 stop":"".concat(B," stops"),duration:"".concat(Math.floor(P/60),"h").concat(P%60,"m"),totalDuration:P,flightRoute:S,departureTime:(null==(m=T[0])||null==(u=m.Departure)?void 0:u.time)||"",arrivalTime:(null==(h=T[T.length-1])||null==(x=h.Arrival)?void 0:x.time)||"",departureAirport:(null==(v=T[0])||null==(p=v.Departure)?void 0:p.location)||e.Departure,arrivalAirport:(null==(g=T[T.length-1])||null==(f=g.Arrival)?void 0:f.location)||e.Arrival,price:w.TotalPrice||0,currency:(null==(b=w.CurrencyCode)?void 0:b.value)||"USD",baggage:(null==C||null==(N=C.BrandAttribute)||null==(j=N.find(e=>"CheckedBag"===e.classification))?void 0:j.inclusion)||"N/A",brandName:(null==C?void 0:C.name)||"",brandImage:(null==C||null==(y=C.ImageURL)?void 0:y[0])||"",fareBreakdown:[{type:"Base Fare",amount:w.Base||0},{type:"Taxes & Fees",amount:w.TotalTaxes||0}]}})));console.log("mapped",d),u(d)}catch(e){h(e instanceof Error?e.message:"Unknown error")}finally{v(!1)}})()},[]),null==(e=j.find(e=>e.value===r))||e.tooltip,(0,a.jsx)(c.A,{children:(0,a.jsxs)("div",{className:"p-4 space-y-5",children:[(0,a.jsx)(d,{route:w.route||"",destination:"BLR",date:w.date||"",passengers:1}),(0,a.jsx)(g,{options:j,selected:r,onChange:i}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-5 space-y-5 ",children:[(0,a.jsx)("div",{id:"scrollableDiv",className:"max-h-[500px] overflow-y-auto",children:(0,a.jsx)(s.A,{dataLength:C.length,next:()=>y(e=>e+1),hasMore:T,scrollableTarget:"scrollableDiv",loader:(0,a.jsx)("p",{className:"text-sm",children:"Loading more flights..."}),children:0===C.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No flights available."}):C.map(e=>(0,a.jsx)(x,{airlineLogoUrl:e.airlineLogoUrl,airlineName:e.airlineName,flightType:e.flightType,duration:e.duration,departureTime:e.departureTime,arrivalTime:e.arrivalTime,departureAirport:e.departureAirport,arrivalAirport:e.arrivalAirport,price:e.price,currency:e.currency,flightRoute:e.flightRoute,brandName:e.brandName,onSelect:()=>alert("Selected flight on ".concat(e.departureTime))},e.id))})}),(0,a.jsx)("div",{children:(0,a.jsx)(f,{details:[{label:"NAME",value:w.name||""},{label:"RANK",value:"1"},{label:"SEAMAN BOOK NO",value:"Z9876543"},{label:"PASSPORT",value:"A1234567"},{label:"ISSUED DATE",value:"01-01-2000"},{label:"EXPIRY DATE",value:"01-01-2030"},{label:"ISSUED AT",value:"BENGALURU"},{label:"NATIONALITY",value:"INDIAN"},{label:"DOB",value:"01-02-1995"},{label:"BAGGAGE",value:"30Kg"}]})})]}),(0,a.jsx)("div",{className:"h-0.5 bg-gray-200 mb-5"}),(0,a.jsxs)("div",{className:"grid gap-5 [grid-template-columns:repeat(auto-fit,minmax(140px,1fr))] max-w-sm mx-auto",children:[(0,a.jsx)(b.A,{addClass:"primary w-full",onClick:()=>console.log("Preview Quote"),children:"Preview Quote"}),(0,a.jsx)(b.A,{addClass:"primary w-full",onClick:()=>console.log("Send Quote"),children:"Send Quote"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5534,3063,635,3486,5262,4303,8534,3198,1025,8441,1684,7358],()=>t(1401)),_N_E=e.O()}]);