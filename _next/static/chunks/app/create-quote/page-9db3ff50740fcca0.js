(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{1401:(e,t,r)=>{Promise.resolve().then(r.bind(r,41720))},24999:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var l=r(95155),a=r(12115),s=r(34303);let i=(0,a.forwardRef)((e,t)=>{let{children:r,addClass:a,btnType:i="button",...o}=e;return(0,l.jsx)(s.Ay,{ref:t,htmlType:i,className:"btn ".concat(a||""),...o,children:r})});i.displayName="CustomButton";let o=i},41720:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var l=r(95155),a=r(12115),s=r(6791),i=r(35695),o=r(34540),n=r(11025),d=r(57340),c=r(69074),u=r(30832),m=r.n(u);let x=e=>{let{route:t,destination:r,date:a,passengers:s}=e,o=(0,i.useRouter)(),n=m()(a).format("DD-MM-YYYY");return(0,l.jsxs)("div",{className:" space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-xs text-blue-700 font-semibold mb-2 underline underline-offset-4",children:"Create Quote"}),(0,l.jsx)("button",{onClick:()=>o.push("/dashboard/"),className:"text-blue-700 hover:text-blue-900 transition-colors","aria-label":"Go to dashboard",children:(0,l.jsx)(d.A,{size:16})})]}),(0,l.jsx)("div",{className:"h-0.5 bg-gray-100 mb-5"}),(0,l.jsxs)("div",{className:"bg-primary text-white rounded-lg px-6 py-3 flex justify-between items-center text-sm md:text-base shadow-md w-full",children:[(0,l.jsx)("div",{className:"font-semibold whitespace-nowrap",children:t}),(0,l.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,l.jsx)(c.A,{className:"h-4 w-4 text-white"}),(0,l.jsx)("span",{children:n})]}),(0,l.jsxs)("div",{className:"whitespace-nowrap",children:[s," Passenger",s>1?"s":""]})]})]})};var h=r(68534),v=r(66766);let p=e=>{let{airlineLogoUrl:t,airlineName:r,flightType:a,duration:s,departureTime:i,arrivalTime:o,departureAirport:n,arrivalAirport:d,price:c,currency:u="USD",flightRoute:m,brandName:x,onSelect:p}=e;return(0,l.jsxs)("div",{className:"border border-borderColor rounded-xl shadow-sm p-4 bg-white mb-5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4 w-1/3",children:[(0,l.jsx)(v.default,{src:t,alt:r,className:"w-12 h-12 rounded-md object-contain",width:80,height:80}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold text-gray-900",children:a}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:s}),(0,l.jsx)("div",{className:"text-sm text-gray-400",children:r})]})]}),(0,l.jsx)("div",{className:"text-center w-1/3",children:(0,l.jsxs)("div",{className:"flex justify-center items-center space-x-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold text-lg",children:i}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:n})]}),(0,l.jsx)("div",{className:"w-8 border-t border-gray-400"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold text-lg",children:o}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:d})]})]})}),(0,l.jsxs)("div",{className:"flex flex-col items-end w-1/3 space-y-2",children:[(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"font-semibold text-gray-900 text-lg",children:[u," ",c.toFixed(2)]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:["Price per person ",(0,l.jsx)("br",{}),"(incl. taxes & fees)"]})]}),(0,l.jsx)(h.A,{variant:"contained",color:"error",size:"small",className:"rounded-full",onClick:p,children:"Select"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"text-xs text-indigo-600 mt-1 p-1 border rounded-sm border-borderColor",children:m}),(0,l.jsx)("div",{className:"text-xs text-indigo-600 mt-1 p-1 border rounded-sm border-borderColor",children:x})]})]})};var f=r(35297),g=r(3127),b=r(81284);let j=e=>{let{details:t}=e;return(0,l.jsx)("div",{className:"border border-borderColor rounded-md p-4 w-full text-sm bg-white shadow-sm",children:(0,l.jsx)("table",{className:"w-full table-auto",children:(0,l.jsx)("tbody",{children:t.map((e,t)=>{let{label:r,value:a,tooltip:s}=e;return(0,l.jsxs)("tr",{className:"border-b border-borderColor last:border-b-0",children:[(0,l.jsxs)("td",{className:"py-2 pr-2 font-medium text-gray-600 flex items-center",children:[r,s&&(0,l.jsx)(f.A,{title:s,arrow:!0,children:(0,l.jsx)(g.A,{size:"small",className:"ml-1",children:(0,l.jsx)(b.A,{size:14})})})]}),(0,l.jsx)("td",{className:"py-2 text-gray-900",children:a})]},t)})})})})},N=e=>{let{options:t,selected:r,onChange:a}=e;return(0,l.jsx)("div",{className:"flex justify-between items-center border border-borderColor rounded-lg overflow-hidden shadow-sm bg-white",children:t.map(e=>(0,l.jsxs)("button",{onClick:()=>a(e.value),className:"flex items-center justify-center relative flex-1 cursor-pointer py-3 text-sm font-medium transition-colors ".concat(r===e.value?"text-blue-600":"text-gray-800"),children:[(0,l.jsx)("span",{children:e.label}),e.tooltip&&(0,l.jsx)(f.A,{title:e.tooltip,arrow:!0,children:(0,l.jsx)(g.A,{size:"small",className:"ml-1",children:(0,l.jsx)(b.A,{size:16})})}),r===e.value&&(0,l.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-600"})]},e.value))})};var y=r(24999);let w=[{label:"Best",value:"best",tooltip:"Best balance of price and duration."},{label:"Cheapest",value:"cheapest",tooltip:"Lowest price first."},{label:"Fastest",value:"fastest",tooltip:"Shortest duration first."}],A=()=>{(0,i.useRouter)();let e=(0,i.useSearchParams)(),t=(0,o.d4)(e=>e.quote.formData),[r,d]=(0,a.useState)("best"),[c,u]=(0,a.useState)([]),[m,h]=(0,a.useState)(""),[v,f]=(0,a.useState)(!0),[g,b]=(0,a.useState)(1),A=(t,r)=>e.get(t)||r||"",C={name:A("name",null==t?void 0:t.name),route:A("route",null==t?void 0:t.route),date:A("date",null==t?void 0:t.departureDate),travelFromCode:A("travelFromCode",null==t?void 0:t.from),travelToCode:A("travelToCode",null==t?void 0:t.to)},T=(0,a.useMemo)(()=>(function(e,t){switch(t){case"cheapest":return[...e].sort((e,t)=>e.price-t.price);case"fastest":let r=Math.min(...e.map(e=>{let t=e.flightType.match(/\d+/);return t?parseInt(t[0]):0}));return[...e].filter(e=>{let t=e.flightType.match(/\d+/);return(t?parseInt(t[0]):0)===r}).sort((e,t)=>e.totalDuration-t.totalDuration);default:return[...e].sort((e,t)=>e.price+e.totalDuration/60-(t.price+t.totalDuration/60))}})(c,r),[c,r]),S=T.slice(0,5*g),P=T.length>S.length;return(0,a.useEffect)(()=>{b(1)},[r]),(0,a.useEffect)(()=>{(async()=>{f(!0),h("");try{var e,t,r;let l=await fetch("/api/travelport/catalog",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CatalogProductOfferingsQueryRequest:{CatalogProductOfferingsRequest:{"@type":"CatalogProductOfferingsRequestAir",maxNumberOfUpsellsToReturn:4,offersPerPage:10,contentSourceList:["GDS"],sortBy:"Price-LowToHigh",SearchCriteriaFlight:[{departureDate:C.date,From:{value:C.travelFromCode},To:{value:C.travelToCode}}],SearchModifiersAir:{CarrierPreference:[{preferenceType:"Preferred",carriers:[]}]}}}})});if(!l.ok)throw Error(await l.text());let a=await l.json(),s=(null==a||null==(t=a.CatalogProductOfferingsResponse)||null==(e=t.CatalogProductOfferings)?void 0:e.CatalogProductOffering)||[],i=(null==a||null==(r=a.CatalogProductOfferingsResponse)?void 0:r.ReferenceList)||[],o=new Map,n=new Map;i.forEach(e=>{"ReferenceListFlight"===e["@type"]&&(e.Flight||[]).forEach(e=>o.set(e.id,e)),"ReferenceListBrand"===e["@type"]&&(e.Brand||[]).forEach(e=>n.set(e.id,e))});let d=s.flatMap(e=>e.ProductBrandOptions.flatMap(t=>t.ProductBrandOffering.map((r,l)=>{var a,s,i,d,c,u,m,x,h,v,p,f,g,b,j,N,y;let w=r.BestCombinablePrice||{},A=null==(a=r.Brand)?void 0:a.BrandRef,C=n.get(A),T=t.flightRefs.map(e=>o.get(e)).filter(Boolean),S=T.reduce((e,t)=>e+function(e){var t,r;let l=e.match(/(\d+)H(?:([0-9]+)M)?/i),a=parseInt(null!=(t=null==l?void 0:l[1])?t:"0"),s=parseInt(null!=(r=null==l?void 0:l[2])?r:"0");return isNaN(a)&&isNaN(s)?0:60*a+s}((null==t?void 0:t.duration)||""),0),P=T.map(e=>{var t;return null==(t=e.Departure)?void 0:t.location}).join(" → ")+" → "+(null==(i=T[T.length-1])||null==(s=i.Arrival)?void 0:s.location),D=Math.max(0,T.length-1);return{id:"".concat(e.id,"-").concat(A,"-").concat(l),airlineName:(null==(d=T[0])?void 0:d.carrier)||"Unknown Airline",airlineLogoUrl:"https://content.r9cdn.net/rimg/provider-logos/airlines/v/".concat((null==(c=T[0])?void 0:c.carrier)||"XX",".png"),flightType:0===D?"Non stop":1===D?"1 stop":"".concat(D," stops"),duration:"".concat(Math.floor(S/60),"h").concat(S%60,"m"),totalDuration:S,flightRoute:P,departureTime:(null==(m=T[0])||null==(u=m.Departure)?void 0:u.time)||"",arrivalTime:(null==(h=T[T.length-1])||null==(x=h.Arrival)?void 0:x.time)||"",departureAirport:(null==(p=T[0])||null==(v=p.Departure)?void 0:v.location)||e.Departure,arrivalAirport:(null==(g=T[T.length-1])||null==(f=g.Arrival)?void 0:f.location)||e.Arrival,price:w.TotalPrice||0,currency:(null==(b=w.CurrencyCode)?void 0:b.value)||"USD",baggage:(null==C||null==(N=C.BrandAttribute)||null==(j=N.find(e=>"CheckedBag"===e.classification))?void 0:j.inclusion)||"N/A",brandName:(null==C?void 0:C.name)||"",brandImage:(null==C||null==(y=C.ImageURL)?void 0:y[0])||"",fareBreakdown:[{type:"Base Fare",amount:w.Base||0},{type:"Taxes & Fees",amount:w.TotalTaxes||0}]}})));u(d)}catch(e){h(e instanceof Error?e.message:"Unknown error")}finally{f(!1)}})()},[C.date,C.travelFromCode,C.travelToCode]),(0,l.jsx)(n.A,{children:(0,l.jsxs)("div",{className:"p-4 space-y-5",children:[(0,l.jsx)(x,{route:C.route,destination:C.travelToCode,date:C.date,passengers:(null==t?void 0:t.passengerCount)||1}),(0,l.jsx)(N,{options:w,selected:r,onChange:d}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-5 space-y-5",children:[(0,l.jsx)("div",{id:"scrollableDiv",className:"max-h-[500px] overflow-y-auto",children:(0,l.jsx)(s.A,{dataLength:S.length,next:()=>b(e=>e+1),hasMore:P,scrollableTarget:"scrollableDiv",loader:(0,l.jsx)("p",{className:"text-sm",children:"Loading more flights..."}),children:0===S.length?(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"No flights available."}):S.map(e=>(0,l.jsx)(p,{airlineLogoUrl:e.airlineLogoUrl,airlineName:e.airlineName,flightType:e.flightType,duration:e.duration,departureTime:e.departureTime,arrivalTime:e.arrivalTime,departureAirport:e.departureAirport,arrivalAirport:e.arrivalAirport,price:e.price,currency:e.currency,flightRoute:e.flightRoute,brandName:e.brandName,onSelect:()=>alert("Selected flight on ".concat(e.departureTime))},e.id))})}),(0,l.jsx)("div",{children:(0,l.jsx)(j,{details:[{label:"NAME",value:C.name},{label:"RANK",value:String((null==t?void 0:t.rank)||"")},{label:"SEAMAN BOOK NO",value:(null==t?void 0:t.seamanBookNo)||""},{label:"PASSPORT",value:(null==t?void 0:t.passport)||""},{label:"ISSUED DATE",value:(null==t?void 0:t.issuedDate)||""},{label:"EXPIRY DATE",value:(null==t?void 0:t.expiryDate)||""},{label:"ISSUED AT",value:(null==t?void 0:t.issuedAt)||""},{label:"NATIONALITY",value:(null==t?void 0:t.nationality)||""},{label:"DOB",value:(null==t?void 0:t.dob)||""},{label:"BAGGAGE",value:"".concat((null==t?void 0:t.baggage)||0,"Kg")}]})})]}),(0,l.jsx)("div",{className:"h-0.5 bg-gray-200 mb-5"}),(0,l.jsxs)("div",{className:"grid gap-5 [grid-template-columns:repeat(auto-fit,minmax(140px,1fr))] max-w-sm mx-auto",children:[(0,l.jsx)(y.A,{addClass:"primary w-full",onClick:()=>console.log("Preview Quote"),children:"Preview Quote"}),(0,l.jsx)(y.A,{addClass:"primary w-full",onClick:()=>console.log("Send Quote"),children:"Send Quote"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5534,3063,635,3486,3268,8534,5249,1025,8441,1684,7358],()=>t(1401)),_N_E=e.O()}]);